{% load threadedcomments_tags %}

<div class="comments_length">
    <p>{{ comment_list|length }} Comments</p>
</div>

<div class="comments">
    {% for comment in comment_list|fill_tree|annotate_tree %}

        {% ifchanged comment.parent_id %}
                <!-- don't start a new list, changed parent_id signals a nested comment -->
        {% else %}
                </li>
        {% endifchanged %}

        {% if not comment.open and not comment.close %}
                </li>
        {% endif %}

        {% if comment.open %}
                <ul>
        {% endif %}

        <li class="comment_li" id="c{{ comment.id }}">{# c## is used by the absolute URL of the Comment model, so keep that as it is. #}
            <div class="comment">
                <div class="comment_info">
                    <div class="comment_user">User: {{ comment.user_name }}</div>
                    <div class="comment_data">Date: {{ comment.submit_date|date:"d M Y, H:i" }}</div>
                </div>
                <div class="comment_text">Text: {{ comment.comment }}</div>
<p>
                <div id="reply{{ comment.id }}comment" >
                  <h5>Reply to Comment: "{{ comment.title }}"</h5>
                  {% render_comment_form for comment.content_object with comment.id %} <!-- comment on c, parent_id = c.id -->
                </div>

            </div>


        {% for close in comment.close %}
                </li></ul>
        {% endfor %}

    {% endfor %}
</div>


<!-- With help from:
https://github.com/bhaugen/nova/blob/master/templates/customer/comments_for_customer.html
https://github.com/HonzaKral/django-threadedcomments/blob/aa945a0db1dbe1e5f886839d5f25c398890d46a0/examples/core/templates/comments/core/list.html -->
